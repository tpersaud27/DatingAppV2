<h2 mat-dialog-title>Create your account</h2>

<form [formGroup]="registerForm" (ngSubmit)="onSubmitRegisterForm()">
  <div mat-dialog-content class="form-grid">
    <mat-form-field appearance="outline" class="span-2">
      <mat-label>Email</mat-label>
      <input matInput type="email" formControlName="email" autocomplete="email" />
      @if (registerForm.get('email')?.hasError('required')) {
      <mat-error>Email is required</mat-error>
      } @if (registerForm.get('email')?.hasError('email')) {
      <mat-error>Enter a valid email</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="span-2">
      <mat-label>Display Name</mat-label>
      <input matInput formControlName="displayName" autocomplete="username" />
      @if (registerForm.get('displayName')?.hasError('required')) {
      <mat-error>Username is required</mat-error>
      } @if (registerForm.get('displayName')?.hasError('minlength')) {
      <mat-error>Username must be at least 3 characters</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Password</mat-label>
      <input
        matInput
        [type]="hidePassword() ? 'password' : 'text'"
        formControlName="password"
        autocomplete="new-password"
      />
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="hidePassword.set(!hidePassword())"
        [attr.aria-label]="hidePassword() ? 'Show password' : 'Hide password'"
      >
        <mat-icon>{{ hidePassword() ? 'visibility' : 'visibility_off' }}</mat-icon>
      </button>
      @if (registerForm.get('password')?.hasError('required')) {
      <mat-error>Password is required</mat-error>
      } @if( registerForm.get('password')?.hasError('minlength')) {
      <mat-error>Password must be at least 6 characters</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Confirm Password</mat-label>
      <input
        matInput
        type="password"
        formControlName="confirmPassword"
        autocomplete="new-password"
      />
      @if (registerForm.get('confirmPassword')?.hasError('required')) {
      <mat-error>Confirm your password</mat-error>
      } @if (registerForm.get('confirmPassword')?.hasError('mismatch')) {
      <mat-error>Passwords do not match</mat-error>
      }
    </mat-form-field>
  </div>

  <div mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCloseRegisterForm()">Cancel</button>
    <button
      mat-flat-button
      color="primary"
      type="submit"
      [disabled]="registerForm.invalid || submitting()"
    >
      {{ submitting() ? 'Creatingâ€¦' : 'Create account' }}
    </button>
  </div>
</form>
